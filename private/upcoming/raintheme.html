<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Win95 Weather Station Pro</title>
<style>
  * { margin: 0; padding: 0; box-sizing: border-box; }
  body {
    background: #008080;
    font-family: 'MS Sans Serif', Arial, sans-serif;
    overflow: hidden; height: 100vh; width: 100vw;
  }
  #weatherCanvas { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 1; }

  /* WINDOWS */
  .window {
    position: absolute; background: #c0c0c0; border: 2px solid;
    border-color: #fff #808080 #808080 #fff; box-shadow: 2px 2px 0 #000;
    width: 320px; z-index: 100;
  }
  .window-titlebar {
    background: linear-gradient(to right, #000080, #1084d0); color: white;
    padding: 3px 4px; display: flex; align-items: center; justify-content: space-between;
    font-weight: bold; font-size: 11px; cursor: move; user-select: none;
  }
  .win-btn {
    width: 16px; height: 14px; background: #c0c0c0; border: 1px solid;
    border-color: #fff #808080 #808080 #fff; font-size: 9px;
    display: flex; align-items: center; justify-content: center; cursor: pointer;
  }
  .window-content { padding: 10px; font-size: 11px; }
  .inset { border: 2px solid; border-color: #808080 #fff #fff #808080; background: #fff; padding: 10px; margin-bottom: 8px; }

  /* UI ELEMENTS */
  .slider-row { display: flex; align-items: center; gap: 8px; margin-bottom: 6px; }
  .slider-label { width: 85px; text-align: right; }
  .slider-val { width: 30px; font-weight: bold; }
  input[type=range] { flex: 1; height: 4px; cursor: pointer; }
  .btn {
    background: #c0c0c0; border: 2px solid; border-color: #fff #808080 #808080 #fff;
    padding: 3px 8px; cursor: pointer; font-size: 11px;
  }
  .btn:active, .btn.active { border-color: #808080 #fff #fff #808080; background: #d0d0d0; }

  /* TASKBAR */
  #taskbar {
    position: fixed; bottom: 0; left: 0; right: 0; height: 28px;
    background: #c0c0c0; border-top: 2px solid #fff;
    display: flex; align-items: center; padding: 2px; z-index: 1000;
  }
  .clock { margin-left: auto; border: 1px solid; border-color: #808080 #fff #fff #808080; padding: 2px 8px; font-size: 11px; }
</style>
</head>
<body>

<canvas id="weatherCanvas"></canvas>

<div class="window" id="weatherControl" style="top: 20px; left: 20px;" onmousedown="focusWindow('weatherControl')">
  <div class="window-titlebar" onmousedown="startDrag(event, 'weatherControl')">
    <span>System Weather Tuner</span>
    <div class="win-btn" onclick="this.parentElement.parentElement.style.display='none'">✕</div>
  </div>
  <div class="window-content">
    <div style="display:flex; gap:4px; margin-bottom:10px;">
      <button class="btn" id="btn-sun" onclick="setMode('sun')">Sun</button>
      <button class="btn" id="btn-rain" onclick="setMode('rain')">Rain</button>
      <button class="btn" id="btn-snow" onclick="setMode('snow')">Snow</button>
      <button class="btn" id="btn-up" onclick="toggleRising()" style="margin-left:auto;">⬆️ Rise</button>
    </div>
    
    <div class="inset">
      <div class="slider-row">
        <span class="slider-label">Density:</span>
        <input type="range" id="densityS" min="10" max="1000" value="400" oninput="updateUI()">
        <span class="slider-val" id="densityV">400</span>
      </div>
      <div class="slider-row">
        <span class="slider-label">Gravity:</span>
        <input type="range" id="speedS" min="1" max="40" value="15" oninput="updateUI()">
        <span class="slider-val" id="speedV">15</span>
      </div>
      <div class="slider-row">
        <span class="slider-label">Wind Force:</span>
        <input type="range" id="windS" min="-40" max="40" value="5" oninput="updateUI()">
        <span class="slider-val" id="windV">5</span>
      </div>
      <div class="slider-row">
        <span class="slider-label" id="extraLabel">Effect Scale:</span>
        <input type="range" id="extraS" min="1" max="50" value="15" oninput="updateUI()">
        <span class="slider-val" id="extraV">15</span>
      </div>
      <div class="slider-row">
        <span class="slider-label">Jitter:</span>
        <input type="range" id="jitterS" min="0" max="100" value="20" oninput="updateUI()">
        <span class="slider-val" id="jitterV">20</span>
      </div>
    </div>
  </div>
</div>

<div id="taskbar">
  <button class="btn" style="font-weight:bold">Start</button>
  <div class="clock" id="clock">12:00</div>
</div>

<script>
const canvas = document.getElementById('weatherCanvas');
const ctx = canvas.getContext('2d');
let particles = [];
let mode = 'snow';
let isRising = false;
let dragTarget = null, offX, offY, zCount = 100;
let heatTime = 0; // For sun warping

const cfg = { density: 400, speed: 15, wind: 5, extra: 15, jitter: 20 };

function resize() { canvas.width = window.innerWidth; canvas.height = window.innerHeight; }
window.addEventListener('resize', resize);
resize();

function focusWindow(id) {
  const el = document.getElementById(id);
  el.style.zIndex = ++zCount;
}

function startDrag(e, id) {
  dragTarget = document.getElementById(id);
  offX = e.clientX - dragTarget.offsetLeft;
  offY = e.clientY - dragTarget.offsetTop;
  focusWindow(id);
}

document.addEventListener('mousemove', e => {
  if (!dragTarget) return;
  dragTarget.style.left = (e.clientX - offX) + 'px';
  dragTarget.style.top = (e.clientY - offY) + 'px';
});
document.addEventListener('mouseup', () => dragTarget = null);

function setMode(m) {
  mode = m;
  particles = [];
  document.querySelectorAll('[id^="btn-"]').forEach(b => b.classList.remove('active'));
  document.getElementById('btn-'+m).classList.add('active');
  
  // Visual adjustments
  if(m === 'sun') {
    document.body.style.background = '#008080';
    document.getElementById('extraLabel').innerText = 'Heat Warp:';
  } else {
    document.body.style.background = m==='rain'?'#1a202c':'#4a5568';
    document.getElementById('extraLabel').innerText = m==='snow'?'Complexity:':'Streak:';
  }
  updateUI();
}

function toggleRising() {
  isRising = !isRising;
  document.getElementById('btn-up').classList.toggle('active', isRising);
  particles.forEach(p => p.y = isRising ? canvas.height + 100 : -100);
}

function updateUI() {
  cfg.density = +document.getElementById('densityS').value;
  cfg.speed = +document.getElementById('speedS').value;
  cfg.wind = +document.getElementById('windS').value;
  cfg.extra = +document.getElementById('extraS').value;
  cfg.jitter = +document.getElementById('jitterS').value;
  
  document.getElementById('densityV').innerText = cfg.density;
  document.getElementById('speedV').innerText = cfg.speed;
  document.getElementById('windV').innerText = cfg.wind;
  document.getElementById('extraV').innerText = cfg.extra;
  document.getElementById('jitterV').innerText = cfg.jitter + "%";
}

function createParticle(randomY = false) {
  const z = Math.random(); 
  return {
    x: Math.random() * (canvas.width + 600) - 300,
    y: randomY ? Math.random() * canvas.height : (isRising ? canvas.height + 100 : -100),
    z: z,
    v: z * 0.8 + 0.2, 
    o: z * 0.5 + 0.2, 
    phase: Math.random() * Math.PI * 2,
    rot: Math.random() * Math.PI * 2,
    rotS: (Math.random() - 0.5) * 0.05,
    arms: Math.floor(Math.random() * 3) + 4
  };
}

function drawFlake(x, y, p) {
  const size = (cfg.extra / 5) * p.v;
  ctx.save();
  ctx.translate(x, y);
  ctx.rotate(p.rot);
  ctx.strokeStyle = `rgba(255, 255, 255, ${p.o})`;
  ctx.lineWidth = 1;
  for(let i=0; i<p.arms; i++) {
    ctx.rotate((Math.PI * 2) / p.arms);
    ctx.beginPath();
    ctx.moveTo(0, 0);
    ctx.lineTo(0, -size);
    ctx.moveTo(0, -size/2);
    ctx.lineTo(-size/3, -size/1.5);
    ctx.moveTo(0, -size/2);
    ctx.lineTo(size/3, -size/1.5);
    ctx.stroke();
  }
  ctx.restore();
}

function animate() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  heatTime += 0.05;
  
  if(mode === 'sun') {
    const sunX = canvas.width - 100;
    const sunY = 100;
    const warpFactor = cfg.extra / 10;

    // Heat Warp Rings
    for(let i = 0; i < 6; i++) {
      ctx.beginPath();
      const radius = 60 + (i * 35) + (Math.sin(heatTime + i) * 10);
      const alpha = 0.15 / (i + 1);
      ctx.strokeStyle = `rgba(255, 220, 100, ${alpha})`;
      ctx.lineWidth = 20 * warpFactor;
      
      for(let a = 0; a < Math.PI * 2; a += 0.2) {
        const wobble = Math.sin(a * 7 + heatTime * 3) * (4 * warpFactor);
        const rx = sunX + Math.cos(a) * (radius + wobble);
        const ry = sunY + Math.sin(a) * (radius + wobble);
        if(a === 0) ctx.moveTo(rx, ry); else ctx.lineTo(rx, ry);
      }
      ctx.closePath();
      ctx.stroke();
    }

    // Glowing Atmosphere
    const g = ctx.createRadialGradient(sunX, sunY, 10, sunX, sunY, 250 + (Math.sin(heatTime) * 30));
    g.addColorStop(0, 'rgba(255, 255, 180, 0.5)');
    g.addColorStop(1, 'transparent');
    ctx.fillStyle = g; 
    ctx.fillRect(0, 0, canvas.width, canvas.height);
    
    // Sun Core
    ctx.fillStyle = '#fffce0'; 
    ctx.beginPath(); 
    ctx.arc(sunX, sunY, 45 + Math.sin(heatTime*2)*2, 0, Math.PI*2); 
    ctx.fill();

  } else {
    while(particles.length < cfg.density) particles.push(createParticle(true));
    if(particles.length > cfg.density) particles.length = cfg.density;

    particles.forEach(p => {
      if(mode === 'rain') {
        const vSpd = (isRising ? -cfg.speed : cfg.speed) * (p.v * 1.8);
        const hSpd = (cfg.wind * p.v);
        const tailX = p.x - (hSpd * (cfg.extra / 15));
        const tailY = p.y - (vSpd * (cfg.extra / 15));

        const dropGrad = ctx.createLinearGradient(p.x, p.y, tailX, tailY);
        dropGrad.addColorStop(0, `rgba(200, 225, 255, ${p.o})`);
        dropGrad.addColorStop(1, `rgba(200, 225, 255, 0)`);

        ctx.beginPath();
        ctx.strokeStyle = dropGrad;
        ctx.lineWidth = p.z * 1.5; 
        ctx.lineCap = 'round';
        ctx.moveTo(p.x, p.y);
        ctx.lineTo(tailX, tailY);
        ctx.stroke();

        p.x += hSpd + (Math.sin(p.phase) * (cfg.jitter / 20));
        p.y += vSpd;
      } else {
        const vSpd = (isRising ? -cfg.speed : cfg.speed) * (p.v * 0.4);
        const hSpd = (cfg.wind * p.v) + (Math.sin(p.phase) * (cfg.jitter / 10));
        drawFlake(p.x, p.y, p);
        p.x += hSpd;
        p.y += vSpd;
        p.rot += p.rotS;
      }
      p.phase += 0.05;
      const outV = isRising ? p.y < -150 : p.y > canvas.height + 150;
      if(outV || p.x > canvas.width + 500 || p.x < -500) {
        Object.assign(p, createParticle());
      }
    });
  }
  requestAnimationFrame(animate);
}

setInterval(() => {
  const d = new Date();
  document.getElementById('clock').innerText = d.getHours().toString().padStart(2,'0') + ":" + d.getMinutes().toString().padStart(2,'0');
}, 1000);

setMode('snow');
animate();
</script>
</body>
</html>
